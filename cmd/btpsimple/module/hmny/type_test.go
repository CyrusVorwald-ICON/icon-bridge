package hmny

import (
	"encoding/json"
	"testing"

	"github.com/ethereum/go-ethereum/common"
	"github.com/harmony-one/harmony/core/types"
	"github.com/stretchr/testify/require"
)

func TestHmnyReceiptUnmarshal(t *testing.T) {
	data := []byte(`{
		"blockHash": "0xc75ef0b59c71272c2b0c767098a3ba8caf321578e7ff6a32589d3164f3b83b42",
		"blockNumber": "0x176c433",
		"contractAddress": "0x0000000000000000000000000000000000000000",
		"cumulativeGasUsed": "0x13b3957",
		"gasUsed": "0x5540",
		"logs": [],
		"logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
		"root": "0x",
		"sender": "one19tdmfcffvkuc6hjqywy2eznaggph7rwfdtlcrd",
		"status": "0x1",
		"transactionHash": "0x438b96336229509b60e47e021dc4e11953cf9f7558e5bee40d7f602fba283a74",
		"transactionIndex": "0x11",
		"type": 2
	}`)
	r := types.Receipt{}
	err := json.Unmarshal(data, &r)
	require.NoError(t, err, "failed to unmarshal receipt")
	require.Equal(t, r.Status, 1)
	require.Equal(t, r.TxHash, common.HexToHash("0x438b96336229509b60e47e021dc4e11953cf9f7558e5bee40d7f602fba283a74"))
}
